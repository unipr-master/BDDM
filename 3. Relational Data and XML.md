
Oggi gran parte dei dati viene archiviata in database relazionali, mentre molte applicazioni utilizzano XML come formato per lo scambio e la manipolazione delle informazioni. 


![[Pasted image 20250304170253.png|450]]


L'uso di XML è particolarmente diffuso in due ambiti principali della gestione dei dati: la rappresentazione di dati semi-strutturati e lo scambio di informazioni tra applicazioni. Quando i dati condivisi tra applicazioni diverse sono conservati localmente in database relazionali, è necessario un collegamento che permetta di convertire questi due formati. A questo scopo, SQL/XML, un'estensione standard di SQL, offre un linguaggio comune per trasformare i dati relazionali in XML.

## Conversione da SQL a XML (e viceversa)

Per combinare dati relazionali e XML, sono necessarie due operazioni fondamentali: l'estrazione di dati XML da una o più tabelle relazionali e l'archiviazione di XML all'interno di una o più tabelle relazionali. La prima operazione risulta concettualmente più semplice, poiché XML è stato sviluppato per rappresentare sia dati strutturati che semi-strutturati. La seconda, invece, è generalmente più complessa proprio per la stessa ragione. I dati strutturati possono essere facilmente rappresentati sia nei database relazionali sia in XML, mentre i dati semi-strutturati risultano più difficili da organizzare in un formato puramente relazionale.

## Estrarre dati XML da una tabella 

L'estrazione di dati XML da una tabella è un processo relativamente semplice, poiché qualsiasi dato rappresentabile in una tabella può essere strutturato anche in XML. Esistono diverse modalità per realizzare questa conversione. 

#### XML + XQuery

![[Pasted image 20250304171233.png]]

Un primo approccio consiste nell'utilizzo combinato di XML e XQuery, che prevede la rappresentazione della tabella in XML attraverso un processo di mappatura e l'estrazione dei dati tramite tecnologie XML come XQuery.

![[Pasted image 20250304171614.png]]

Durante la fase di mappatura, il nome della tabella viene utilizzato come nome del documento XML. Ogni riga della tabella viene rappresentata come un elemento `<row>`, mentre ogni valore di colonna viene inserito all'interno di un elemento XML con il nome corrispondente all'attributo SQL originale. Nel caso di valori nulli, questi vengono esplicitamente indicati utilizzando l'attributo `xsi:nil="true"`, garantendo così una corretta rappresentazione dei dati mancanti nel formato XML. In generale, la mappatura tra dati relazionali e XML è definita dallo standard SQL/XML. 

![[Pasted image 20250304172336.png|400]]

Un esempio di rappresentazione XML di una tabella dipendenti prevede che il documento abbia il nome della tabella come elemento principale, con ogni riga della tabella incapsulata in un elemento `<row>`. All'interno di ciascun elemento riga, i valori delle colonne vengono inseriti come sotto-elementi con il nome corrispondente all'attributo SQL.



Oltre alla rappresentazione XML dei dati, lo standard prevede anche la definizione di uno schema XML che specifica il tipo di dati per ogni elemento XML, in corrispondenza con i tipi di dati SQL. Ad esempio, un attributo `CHARACTER(6)` viene definito nello schema XML come un tipo semplice (`xsd:sempleType`), con una restrizione sulla lunghezza della stringa.

Un esempio di query XQuery mostra come sia possibile interrogare il documento XML ottenuto dalla tabella per estrarre informazioni specifiche. In questo caso, la query seleziona i dipendenti con uno stipendio superiore a 18.000, restituendo solo i loro nomi e cognomi all'interno di elementi `<employee>`. Questo esempio rappresenta una funzione XQuery non standard, ed è fornito solo a scopo illustrativo, senza entrare nei dettagli del linguaggio XQuery nei materiali trattati.




![[Pasted image 20250304171645.png|400]]
